<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>FICHA DE IMPRESIÓN OFICIAL - POLICÍA NACIONAL</title>
    <!-- Importamos el CSS Externo (Verifica si es CSS o css según tu carpeta) -->
    <link rel="stylesheet" href="css/estilos.css">
</head>
<body>

    <!-- Botón para imprimir (no sale en el papel gracias a la clase no-print) -->
    <div style="text-align: center; margin-bottom: 20px;" class="no-print">
        <button onclick="window.print()" style="padding: 10px 20px; cursor: pointer; font-weight: bold; border-radius: 5px;">Imprimir Ficha Oficial</button>
    </div>

    <!-- CONTENEDOR TIPO HOJA DE PAPEL -->
    <div class="form-page">

        <!-- ENCABEZADO OFICIAL -->
        <div class="header-official">
            <img src="img/Logo_policia.png" alt="Logo PN">
            
            <div class="institutional-text">
                REPÚBLICA DE PANAMÁ<br>
                MINISTERIO DE SEGURIDAD PÚBLICA<br>
                POLICÍA NACIONAL<br>
                DIRECCIÓN NACIONAL DE RECURSOS HUMANOS<br>
                DEPARTAMENTO DE RECLUTAMIENTO Y SELECCIÓN
            </div>

            <div class="photo-container" id="foto">
                <svg width="30" height="30" viewBox="0 0 16 16" fill="#888"><path d="M3 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H3zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
                <small style="font-size: 8px; margin-top: 5px;">TOMAR / SUBIR FOTO</small>
            </div>
        </div>

        <!-- FECHA Y CARGO -->
        <div class="row-print" style="margin-top: 20px;">
            <div class="col-print" style="flex: 0.4;">
                <label class="label-sm">FECHA</label>
                <div id="fecha" class="field-print"></div>
            </div>
            <div class="col-print">
                <label class="label-sm">POSTULARÁ PARA:</label>
                <div id="cargo" class="field-print"></div>
            </div>
        </div>

        <!-- SECCIÓN I: DATOS GENERALES -->
        <div class="box-title">I. DATOS GENERALES</div>
        <div class="border-section">
            <div class="row-print">
                <div class="col-print"><label class="label-sm">1er. Apellido</label><div id="apellido1" class="field-print"></div></div>
                <div class="col-print"><label class="label-sm">2do. Apellido</label><div id="apellido2" class="field-print"></div></div>
                <div class="col-print"><label class="label-sm">1er. Nombre</label><div id="nombre1" class="field-print"></div></div>
                <div class="col-print"><label class="label-sm">2do. Nombre</label><div id="nombre2" class="field-print"></div></div>
            </div>

            <div class="row-print" style="margin-top: 15px;">
                <div class="col-print" style="flex: 1.5;">
                    <label class="label-sm">CÉDULA</label>
                    <div id="cedula" class="field-print"></div>
                </div>
                <div class="col-print"><label class="label-sm">APODO</label><div id="apodo" class="field-print"></div></div>
                <div class="col-print" style="flex: 1.5;"><label class="label-sm">RELIGIÓN</label><div id="religion" class="field-print"></div></div>
            </div>

            <div class="row-print" style="margin-top: 15px;">
                <div class="col-print"><label class="label-sm">FECHA DE NACIMIENTO</label><div id="fechaNac" class="field-print"></div></div>
                <div class="col-print" style="flex: 0.4;"><label class="label-sm">EDAD</label><div id="edad" class="field-print"></div></div>
                <div class="col-print" style="flex: 0.6;"><label class="label-sm">TIPAJE</label><div id="tipaje" class="field-print"></div></div>
                <div class="col-print"><label class="label-sm">ESTADO CIVIL</label><div id="estadoCivil" class="field-print"></div></div>
                <div class="col-print"><label class="label-sm">IDIOMA</label><div id="idioma" class="field-print"></div></div>
            </div>
        </div>

        <!-- SECCIÓN II: DIRECCIÓN -->
        <div class="box-title">II. DIRECCIÓN RESIDENCIAL</div>
        <div class="border-section">
            <div class="row-print">
                <div class="col-print"><label class="label-sm">PROVINCIA</label><div id="provincia" class="field-print"></div></div>
                <div class="col-print"><label class="label-sm">DISTRITO</label><div id="distrito" class="field-print"></div></div>
            </div>
            <div class="row-print" style="margin-top: 15px;">
                <div class="col-print"><label class="label-sm">CORREGIMIENTO Y SECTOR</label><div id="corregimiento" class="field-print"></div></div>
            </div>
            <div class="row-print" style="margin-top: 15px;">
                <div class="col-print"><label class="label-sm">N° CASA Y COLOR</label><div id="casaColor" class="field-print"></div></div>
                <div class="col-print"><label class="label-sm">TIEMPO RESIDENCIA</label><div id="tiempoResidencia" class="field-print"></div></div>
                <div class="col-print"><label class="label-sm">TELÉFONOS</label><div id="telefonoResidencia" class="field-print"></div></div>
            </div>
        </div>

        <!-- SECCIÓN III: DATOS FAMILIARES -->
        <div class="box-title">III. DATOS FAMILIARES</div>
        <div class="border-section">
            <div class="row-print">
                <div class="col-print"><label class="label-sm">NOMBRE DEL PADRE</label><div id="padre" class="field-print"></div></div>
                <div class="col-print" style="flex: 0.6;"><label class="label-sm">PROFESIÓN / TEL</label><div id="padreProf" class="field-print"></div></div>
            </div>
            <div class="row-print" style="margin-top: 15px;">
                <div class="col-print"><label class="label-sm">NOMBRE DE LA MADRE</label><div id="madre" class="field-print"></div></div>
                <div class="col-print" style="flex: 0.6;"><label class="label-sm">PROFESIÓN / TEL</label><div id="madreProf" class="field-print"></div></div>
            </div>
        </div>

        <!-- PÁGINA 2 (OPCIONAL) -->
        <!-- <div class="pagebreak"></div> -->

    </div> <!-- FIN FORM-PAGE -->

    <script>
        const URL_API = "https://script.google.com/macros/s/AKfycbzEE0t9HvVEaTDFLuhRniUVDDFRH76NDywsoWWYBZUMPR48yi3-JJAzbi8cV4FXXwu3/exec";

        document.addEventListener("DOMContentLoaded", async () => {
            const cedula = localStorage.getItem("target_cedula");
            if (!cedula) return;

            try {
                const res = await fetch(`${URL_API}?cedula=${encodeURIComponent(cedula)}`);
                const p = await res.json();

                const set = (id, val) => {
                    const el = document.getElementById(id);
                    if (el) el.innerText = val || "";
                };

                // Llenado (Coincidiendo con tus nombres de Excel)
                set("fecha", p["Fecha postulacion"]);
                set("cargo", p["Cargo al que se postula"]);
                set("apellido1", p["1er Apellido"]);
                set("apellido2", p["2do. Apellido"]);
                set("nombre1", p["1er Nombre"]);
                set("nombre2", p["2do Nombre"]);
                set("cedula", p["Cedula"]);
                set("apodo", p["Apodo"]);
                set("religion", p["Religion"]);
                set("fechaNac", p["Fecha de nacimiento"]);
                set("edad", p["Edad"]);
                set("tipaje", p["Tipaje"]);
                set("estadoCivil", p["Estado civil"]);
                set("idioma", p["Idioma"]);
                set("provincia", p["Provincia"]);
                set("distrito", p["Distrito"]);
                set("corregimiento", p["Corregimiento"]);
                set("casaColor", p["N de casa y color"]);
                set("tiempoResidencia", p["Tiempo de residencia (años)"]);
                set("telefonoResidencia", p["Telefono residencia"]);
                set("padre", p["Nombre del padre"]);
                set("padreProf", p["Padre profesion"]);
                set("madre", p["Nombre de la madre"]);
                set("madreProf", p["Madre profesion"]);

                // Foto
                if (p["Link_recluta_foto"] && p["Link_recluta_foto"] !== "Sin foto") {
                    const fotoDiv = document.getElementById("foto");
                    fotoDiv.innerHTML = `<img src="${p["Link_recluta_foto"]}" style="width:100%;height:100%;object-fit:cover;">`;
                    fotoDiv.style.border = "none";
                }
            } catch (e) { console.error("Error al cargar datos:", e); }
        });
    </script>
</body>
</html>