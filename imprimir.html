<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FICHA DE IMPRESIÓN - RECLUTAMIENTO PN</title>

    <!-- Enlace a Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Enlace a tu archivo CSS personalizado -->
    <link rel="stylesheet" href="css/estilos.css">

    <style>
        /* CONFIGURACIÓN EXCLUSIVA PARA IMPRESIÓN 8.5 x 11 */
        @media print {
            body { background: white !important; margin: 0; padding: 0; }
            .container { width: 100% !important; max-width: 100% !important; padding: 0 !important; margin: 0 !important; }
            
            /* Cada página de tu formulario será una hoja de papel física */
            .form-page {
                width: 215.9mm !important; /* Ancho Carta */
                height: 279.4mm !important; /* Alto Carta */
                padding: 10mm !important;
                margin: 0 auto !important;
                border: 1px solid #000 !important;
                box-shadow: none !important;
                display: block !important; /* Asegura que sean visibles */
                page-break-after: always; /* SALTO DE PÁGINA OBLIGATORIO */
                overflow: hidden;
            }

            /* Ocultar cualquier cosa que no deba imprimirse */
            .no-print, .btn, .success-icon { display: none !important; }
            
            /* Ajuste para que los inputs se vean como texto normal en el PDF */
            input, select, textarea {
                border: none !important;
                background: transparent !important;
                padding: 0 !important;
            }
        }
    </style>
</head>
<body class="bg-white">

    <div class="container">

        <!-- PÁGINA 1: DATOS GENERALES -->
        <div id="page-1" class="form-page bg-white">
            <div class="row align-items-center mb-4 g-2">
                <div class="col-3 col-md-2 text-start">
                    <img src="img/Logo_policia.png" alt="Logo PN" class="img-fluid" style="max-width: 80px;">
                </div>
                <div class="col-6 col-md-8 text-center">
                    <h6 class="fw-bold institutional-text m-0">
                        REPÚBLICA DE PANAMÁ<br>
                        MINISTERIO DE SEGURIDAD PÚBLICA<br>
                        POLICÍA NACIONAL<br>
                        DIRECCIÓN NACIONAL DE RECURSOS HUMANOS
                    </h6>
                </div>
                <div class="col-3 col-md-2 text-end">
                    <div id="photo-preview" class="photo-container ms-auto border border-dark" style="width: 85px; height: 110px;">
                        <!-- Aquí se cargará la foto del recluta -->
                    </div>
                </div>
            </div>

            <div class="row g-2 mb-3">
                <div class="col-4"><label class="label-sm">Fecha</label><input type="text" id="fechaPostulacion" class="form-control border-bottom"></div>
                <div class="col-8"><label class="label-sm">Postulará para:</label><input type="text" id="postulacionCargo" class="form-control border-bottom"></div>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold">I.- DATOS GENERALES</div>
            <div class="border-section border border-dark p-3 mb-4">
                <div class="row g-2 mb-2">
                    <div class="col-3"><label class="label-sm">1er. Apellido</label><input type="text" id="apellido1" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">2do. Apellido</label><input type="text" id="apellido2" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">1er. Nombre</label><input type="text" id="inputNombre" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">2do. Nombre</label><input type="text" id="nombre2" class="form-control"></div>
                </div>
                <div class="row g-2">
                    <div class="col-4"><label class="label-sm">Cédula</label><input type="text" id="inputCedula" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Fecha Nac.</label><input type="text" id="txtFechaNac" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Edad</label><input type="text" id="txtEdad" class="form-control"></div>
                </div>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold">II.- DIRECCIÓN RESIDENCIAL</div>
            <div class="border-section border border-dark p-3 mb-4">
                <div class="row g-2">
                    <div class="col-6"><label class="label-sm">Provincia</label><input type="text" id="resProvincia" class="form-control"></div>
                    <div class="col-6"><label class="label-sm">Distrito</label><input type="text" id="resDistrito" class="form-control"></div>
                    <div class="col-12"><label class="label-sm">Corregimiento</label><input type="text" id="resCorregimiento" class="form-control"></div>
                </div>
            </div>
            
            <div class="box-title bg-dark text-white p-1 px-3 fw-bold">III.- DATOS FAMILIARES</div>
            <div class="border-section border border-dark p-3">
                <div class="row g-2 border-bottom pb-2">
                    <div class="col-8"><label class="label-sm">Nombre Padre</label><input type="text" id="padreNombre" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Teléfono</label><input type="text" id="padreTelefono" class="form-control"></div>
                </div>
                <div class="row g-2">
                    <div class="col-8"><label class="label-sm">Nombre Madre</label><input type="text" id="madreNombre" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Teléfono</label><input type="text" id="madreTelefono" class="form-control"></div>
                </div>
            </div>
        </div>

        <!-- PÁGINA 2: ESTUDIOS Y SALUD -->
        <div id="page-2" class="form-page bg-white">
            <div class="box-title bg-dark text-white p-1 px-3 fw-bold mb-0">V.- ESTUDIOS</div>
            <div class="border-section border border-dark mb-4 p-0">
                <table class="table table-bordered mb-0 border-dark">
                    <thead>
                        <tr class="text-center align-middle bg-light">
                            <th style="width: 20%;">NIVEL</th>
                            <th style="width: 40%;">CENTRO DE ESTUDIO</th>
                            <th style="width: 40%;">TÍTULO OBTENIDO</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>INICIAL</td><td><input type="text" id="estIniC" class="form-control-clean"></td><td><input type="text" id="estIniT" class="form-control-clean"></td></tr>
                        <tr><td>MEDIA</td><td><input type="text" id="estMedC" class="form-control-clean"></td><td><input type="text" id="estMedT" class="form-control-clean"></td></tr>
                        <tr><td>SUPERIOR</td><td><input type="text" id="estSupC" class="form-control-clean"></td><td><input type="text" id="estSupT" class="form-control-clean"></td></tr>
                    </tbody>
                </table>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold mb-0">XI.- ANTECEDENTES PERSONALES</div>
            <div class="border-section border border-dark p-3">
                <div id="contenedor-salud-impresion">
                    <!-- Aquí el script llenará la lista de salud -->
                </div>
            </div>
        </div>

        <!-- PÁGINA 3: MOTIVACIONES Y FIRMAS -->
        <div id="page-3" class="form-page bg-white">
            <div class="box-title bg-dark text-white p-1 px-3 fw-bold mb-0">XV.- MOTIVACIONES</div>
            <div class="border-section border border-dark p-3 mb-4">
                <p class="small fw-bold">¿QUÉ LO MOTIVÓ INGRESAR A LA POLICÍA NACIONAL?</p>
                <div id="p-motivo1" class="border-bottom mb-3" style="min-height: 40px;"></div>
                
                <p class="small fw-bold">¿ESTÁ DISPUESTO A BRINDAR SU VIDA EN EL DEBER?</p>
                <div id="p-motivo5" class="border-bottom" style="min-height: 40px;"></div>
            </div>

            <div class="row mt-5 pt-5 text-center">
                <div class="col-6">
                    <div class="border-top border-dark mx-auto" style="width: 80%;"></div>
                    <p class="fw-bold mt-2">FIRMA DEL POSTULANTE</p>
                </div>
                <div class="col-6">
                    <div class="border-top border-dark mx-auto" style="width: 80%;"></div>
                    <p class="fw-bold mt-2">FIRMA DEL RECLUTADOR</p>
                </div>
            </div>
        </div>

    </div>

    <!-- SCRIPT PARA LLENAR LA FICHA AUTOMÁTICAMENTE -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const cedula = localStorage.getItem('print_cedula');
            const URL_GOOGLE = "TU_URL_DE_APPS_SCRIPT_AQUI";

            if (!cedula) {
                alert("No se seleccionó ningún recluta.");
                return;
            }

            fetch(URL_GOOGLE)
                .then(res => res.json())
                .then(data => {
                    const p = data.find(item => item.cedula == cedula);
                    if (p) {
                        // Llenar campos de texto e inputs
                        document.getElementById('inputNombre').value = p.nombre1 || '';
                        document.getElementById('apellido1').value = p.apellido1 || '';
                        document.getElementById('inputCedula').value = p.cedula || '';
                        document.getElementById('txtEdad').value = p.edad || '';
                        
                        // Llenar motivaciones en los DIVs
                        document.getElementById('p-motivo1').innerText = p.motivo1 || 'N/A';
                        document.getElementById('p-motivo5').innerText = p.motivo5 || 'N/A';

                        // Cargar Foto
                        if(p.foto && p.foto !== "Sin foto") {
                            document.getElementById('photo-preview').innerHTML = `<img src="${p.foto}" style="width:100%;height:100%;object-fit:cover;">`;
                        }

                        // Lanzar impresión tras 2 segundos para dar tiempo a cargar la foto
                        setTimeout(() => { window.print(); }, 2000);
                    }
                });
        });
    </script>
</body>
</html>