<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FICHA DE IMPRESIÓN OFICIAL - POLICÍA NACIONAL</title>

    <!-- Enlace a Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Enlace a tu archivo CSS -->
    <link rel="stylesheet" href="css/estilos.css">

    <style>
        /* CONFIGURACIÓN PARA IMPRESIÓN PROFESIONAL 8.5 x 11 */
        @media print {
            body { background: white !important; margin: 0; padding: 0; }
            .container { width: 100% !important; max-width: 100% !important; padding: 0 !important; margin: 0 !important; }
            
            .form-page {
                width: 215.9mm !important; 
                height: 279.4mm !important; 
                padding: 12mm !important;
                margin: 0 auto !important;
                border: 1px solid #000 !important;
                box-shadow: none !important;
                display: block !important; 
                page-break-after: always; 
                overflow: hidden;
            }

            .no-print, .btn, #success-screen { display: none !important; }
            
            /* Ajuste para que los campos parezcan texto impreso */
            input, select, textarea {
                border: none !important;
                background: transparent !important;
                padding: 0 !important;
                font-weight: bold !important;
                color: black !important;
            }
        }
        
        .form-page {
            display: block !important; 
            margin-bottom: 30px;
        }
    </style>
</head>
<body class="bg-white">

    <div class="container py-4">

        <!-- PÁGINA 1: DATOS GENERALES, DIRECCIÓN Y FAMILIA -->
        <div id="page-1" class="form-page bg-white p-4 mx-auto">
            <!-- ENCABEZADO -->
            <div class="row align-items-center mb-4 g-2">
                <div class="col-3 col-md-2 text-start">
                    <img src="img/Logo_policia.png" alt="Logo PN" class="img-fluid" style="max-width: 80px;">
                </div>
                <div class="col-6 col-md-8 text-center">
                    <h6 class="fw-bold institutional-text m-0">
                        REPÚBLICA DE PANAMÁ<br>
                        MINISTERIO DE SEGURIDAD PÚBLICA<br>
                        POLICÍA NACIONAL<br>
                        DIRECCIÓN NACIONAL DE RECURSOS HUMANOS<br>
                        DEPARTAMENTO DE RECLUTAMIENTO Y SELECCIÓN
                    </h6>
                </div>
                <div class="col-3 col-md-2 text-end">
                    <div id="photo-preview" class="photo-container ms-auto d-flex align-items-center justify-content-center border border-dark" style="width: 85px; height: 110px;">
                        <small class="text-muted">FOTO</small>
                    </div>
                </div>
            </div>

            <div class="row g-2 align-items-end mb-3">
                <div class="col-4"><label class="label-sm fw-bold">Fecha</label><input type="text" id="fechaPostulacion" class="form-control border-black"></div>
                <div class="col-8"><label class="label-sm fw-bold">Postulará para:</label><input type="text" id="postulacionCargo" class="form-control border-black"></div>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold">I.- DATOS GENERALES</div>
            <div class="border-section border border-dark p-3 mb-4">
                <div class="row g-2 mb-2">
                    <div class="col-3"><label class="label-sm">1er. Apellido</label><input type="text" id="apellido1" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">2do. Apellido</label><input type="text" id="apellido2" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">1er. Nombre</label><input type="text" id="inputNombre" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">2do. Nombre</label><input type="text" id="nombre2" class="form-control"></div>
                </div>
                <div class="row g-2 mb-2">
                    <div class="col-4"><label class="label-sm">Cédula</label><input type="text" id="inputCedula" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Apodo</label><input type="text" id="inputApodo" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Religión</label><input type="text" id="inputReligion" class="form-control"></div>
                </div>
                <div class="row g-2">
                    <div class="col-3"><label class="label-sm">Fecha Nac.</label><input type="text" id="txtFechaNac" class="form-control"></div>
                    <div class="col-2"><label class="label-sm">Edad</label><input type="text" id="txtEdad" class="form-control"></div>
                    <div class="col-2"><label class="label-sm">Tipaje</label><input type="text" id="inputTipaje" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">Edo. Civil</label><input type="text" id="selEstadoCivil" class="form-control"></div>
                    <div class="col-2"><label class="label-sm">Idioma</label><input type="text" id="inputIdioma" class="form-control"></div>
                </div>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold">II.- DIRECCIÓN RESIDENCIAL</div>
            <div class="border-section border border-dark p-3 mb-4">
                <div class="row g-2 mb-2">
                    <div class="col-6"><label class="label-sm">Provincia</label><input type="text" id="resProvincia" class="form-control"></div>
                    <div class="col-6"><label class="label-sm">Distrito</label><input type="text" id="resDistrito" class="form-control"></div>
                </div>
                <div class="row g-2 mb-2">
                    <div class="col-12"><label class="label-sm">Corregimiento y Sector</label><input type="text" id="resCorregimiento" class="form-control"></div>
                </div>
                <div class="row g-2">
                    <div class="col-4"><label class="label-sm">N° Casa y Color</label><input type="text" id="resCasaColor" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Tiempo (Años)</label><input type="text" id="resTiempoResidencia" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Teléfonos</label><input type="text" id="resTelefonos" class="form-control"></div>
                </div>
                <div class="col-12 mt-2"><label class="label-sm">Dirección Anterior</label><input type="text" id="resDireccionAnterior" class="form-control"></div>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold">III.- DATOS FAMILIARES</div>
            <div class="border-section border border-dark p-3">
                <div class="row g-2 border-bottom border-dark pb-2 mb-2">
                    <div class="col-8"><label class="label-sm">Nombre Padre</label><input type="text" id="padreNombre" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Profesión</label><input type="text" id="padreProfesion" class="form-control"></div>
                    <div class="col-8"><label class="label-sm">Dirección</label><input type="text" id="padreDireccion" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Teléfono</label><input type="text" id="padreTelefono" class="form-control"></div>
                </div>
                <div class="row g-2 border-bottom border-dark pb-2">
                    <div class="col-8"><label class="label-sm">Nombre Madre</label><input type="text" id="madreNombre" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Profesión</label><input type="text" id="madreProfesion" class="form-control"></div>
                    <div class="col-8"><label class="label-sm">Dirección</label><input type="text" id="madreDireccion" class="form-control"></div>
                    <div class="col-4"><label class="label-sm">Teléfono</label><input type="text" id="madreTelefono" class="form-control"></div>
                </div>
                <div class="row g-2 mt-2">
                    <div class="col-6"><label class="label-sm">Padrastro</label><input type="text" id="padrastroNombre" class="form-control"></div>
                    <div class="col-6"><label class="label-sm">Madrastra</label><input type="text" id="madrastraNombre" class="form-control"></div>
                </div>
            </div>
        </div>

        <!-- PÁGINA 2: DESCRIPCIÓN FÍSICA, ESTUDIOS, REFERENCIAS Y SALUD -->
        <div id="page-2" class="form-page bg-white p-4 mx-auto">
            <div class="box-title bg-dark text-white p-1 px-3 fw-bold mb-0">IV.- DESCRIPCIÓN FÍSICA</div>
            <div class="border-section border border-dark p-3 mb-4">
                <div class="row g-2">
                    <div class="col-3"><label class="label-sm">Estatura</label><input type="text" id="descEstatura" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">Peso</label><input type="text" id="descPeso" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">Ojos</label><input type="text" id="descColorOjos" class="form-control"></div>
                    <div class="col-3"><label class="label-sm">Tez</label><input type="text" id="descTez" class="form-control"></div>
                </div>
                <div class="col-12 mt-2"><label class="label-sm">Señas Particulares</label><input type="text" id="descSenas" class="form-control"></div>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold mb-0">V.- ESTUDIOS</div>
            <div class="border-section border border-dark p-0 mb-4">
                <table class="table-oficial mb-0">
                    <thead><tr><th style="width: 20%;">NIVEL</th><th>CENTRO ESTUDIO</th><th>TÍTULO OBTENIDO</th></tr></thead>
                    <tbody>
                        <tr><td>INICIAL</td><td><input type="text" id="estIniC" class="form-control-clean"></td><td><input type="text" id="estIniT" class="form-control-clean"></td></tr>
                        <tr><td>MEDIA</td><td><input type="text" id="estMedC" class="form-control-clean"></td><td><input type="text" id="estMedT" class="form-control-clean"></td></tr>
                        <tr><td>SUPERIOR</td><td><input type="text" id="estSupC" class="form-control-clean"></td><td><input type="text" id="estSupT" class="form-control-clean"></td></tr>
                    </tbody>
                </table>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold mb-0">XI.- ANTECEDENTES PERSONALES (1-22)</div>
            <div class="border-section border border-dark p-3 mb-4">
                <div class="row" id="render-salud-1">
                    <!-- El script llenará esto -->
                </div>
            </div>
        </div>

        <!-- PÁGINA 3: SALUD (CONT), HÁBITOS, MOTIVACIONES Y FIRMAS -->
        <div id="page-3" class="form-page bg-white p-4 mx-auto">
            <div class="box-title bg-dark text-white p-1 px-3 fw-bold mb-0">XI.- ANTECEDENTES PERSONALES (CONT. 23-31)</div>
            <div class="border-section border border-dark p-3 mb-4">
                <div id="render-salud-2"></div>
            </div>

            <div class="box-title bg-dark text-white p-1 px-3 fw-bold mb-0">XV.- MOTIVACIONES</div>
            <div class="border-section border border-dark p-3 mb-4">
                <p class="small fw-bold">1.- ¿QUÉ LO MOTIVÓ INGRESAR A LA POLICÍA NACIONAL?</p>
                <div id="print-motivo1" class="border-bottom mb-3 pb-1" style="min-height: 30px;"></div>
                <p class="small fw-bold">5.- ¿ESTÁ DISPUESTO A BRINDAR SU VIDA EN EL DEBER?</p>
                <div id="print-motivo5" class="border-bottom pb-1" style="min-height: 30px;"></div>
            </div>

            <div class="row mt-5 text-center">
                <div class="col-6"><p class="border-top border-dark pt-2 fw-bold">FIRMA DEL POSTULANTE</p></div>
                <div class="col-6"><p class="border-top border-dark pt-2 fw-bold">FIRMA DEL RECLUTADOR</p></div>
            </div>
        </div>

    </div>

    <!-- SCRIPT DE AUTO-LLENADO -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const targetCedula = localStorage.getItem('target_cedula');
            const URL_GOOGLE = "TU_URL_DE_APPS_SCRIPT_AQUI"; // REEMPLAZA CON TU URL /EXEC

            if (!targetCedula) {
                alert("No se ha seleccionado ningún recluta.");
                return;
            }

            fetch(URL_GOOGLE)
                .then(res => res.json())
                .then(data => {
                    const p = data.find(item => item.cedula == targetCedula);
                    if (!p) { alert("Datos no encontrados"); return; }

                    // ASIGNACIÓN DE DATOS - PÁGINA 1
                    document.getElementById('fechaPostulacion').value = p.fechaPostulacion || '';
                    document.getElementById('postulacionCargo').value = p.postulacionCargo || '';
                    document.getElementById('apellido1').value = p.apellido1 || '';
                    document.getElementById('apellido2').value = p.apellido2 || '';
                    document.getElementById('inputNombre').value = p.nombre1 || '';
                    document.getElementById('nombre2').value = p.nombre2 || '';
                    document.getElementById('inputCedula').value = p.cedula || '';
                    document.getElementById('txtFechaNac').value = p.fechaNac || '';
                    document.getElementById('txtEdad').value = p.edad || '';
                    document.getElementById('selEstadoCivil').value = p.estadoCivil || '';
                    
                    document.getElementById('resProvincia').value = p.provincia || '';
                    document.getElementById('resDistrito').value = p.distrito || '';
                    document.getElementById('resCorregimiento').value = p.corregimiento || '';
                    document.getElementById('resCasaColor').value = p.casaColor || '';
                    document.getElementById('resTelefonos').value = p.telefonos || '';

                    document.getElementById('padreNombre').value = p.padreNombre || '';
                    document.getElementById('padreProfesion').value = p.padreProfesion || '';
                    document.getElementById('padreTelefono').value = p.padreTelefono || '';
                    document.getElementById('madreNombre').value = p.madreNombre || '';
                    document.getElementById('madreTelefono').value = p.madreTelefono || '';

                    // ASIGNACIÓN DE DATOS - PÁGINA 2
                    document.getElementById('descEstatura').value = p.estatura || '';
                    document.getElementById('descPeso').value = p.peso || '';
                    document.getElementById('estIniC').value = p.estIniC || '';
                    document.getElementById('estMedC').value = p.estMedC || '';
                    document.getElementById('estSupC').value = p.estSupC || '';

                    // MOTIVACIONES
                    document.getElementById('print-motivo1').innerText = p.motivo1 || '';
                    document.getElementById('print-motivo5').innerText = p.motivo5 || '';

                    // CARGA DE FOTO
                    if(p.foto && p.foto !== "Sin foto") {
                        document.getElementById('photo-preview').innerHTML = `<img src="${p.foto}" style="width:100%;height:100%;object-fit:cover;">`;
                    }

                    // AUTO IMPRESIÓN
                    setTimeout(() => { window.print(); }, 2500);
                });
        });
    </script>
</body>
</html>