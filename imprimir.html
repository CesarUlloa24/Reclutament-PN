code
Html
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FICHA DE INSCRIPCI√ìN OFICIAL - PN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; font-family: 'Segoe UI', sans-serif; color: #333; }
        
        .form-page {
            width: 215.9mm; min-height: 279.4mm; padding: 15mm;
            margin: 20px auto; background: white; box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }

        /* CABECERA */
        .header-institutional { display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px; }
        .header-text { text-align: center; flex-grow: 1; font-weight: bold; line-height: 1.2; font-size: 14px; color: #000; }
        .photo-box { width: 95px; height: 115px; border: 1px solid #000; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 12px; background: #fff; overflow: hidden; }

        /* T√çTULOS DE SECCI√ìN */
        .box-title { background-color: #34495e; color: white; padding: 6px 15px; font-weight: bold; font-size: 13px; text-transform: uppercase; border-radius: 4px 4px 0 0; margin-top: 15px; }

        /* DISE√ëO DE CAMPOS */
        .label-sm { font-size: 10px; font-weight: bold; color: #2c3e50; margin-bottom: 2px; text-transform: uppercase; }
        .form-data {
            border: 1px solid #ced4da; border-radius: 8px; padding: 6px 12px; font-size: 13px;
            background-color: #fff; min-height: 38px; display: flex; align-items: center;
            font-weight: 600; color: #000; word-break: break-word; line-height: 1.2;
        }

        .border-section { border: 1px solid #dee2e6; border-top: none; padding: 15px; border-radius: 0 0 8px 8px; margin-bottom: 10px; }
        
        @media print {
            body { background: white; margin: 0; }
            .form-page { margin: 0; border: none; box-shadow: none; width: 100%; }
            .no-print { display: none !important; }
        }
    </style>
</head>
<body>

    <div class="no-print text-center py-3">
        <button class="btn btn-dark btn-lg" onclick="window.print()">üñ®Ô∏è GENERAR DOCUMENTO PDF</button>
    </div>

    <div class="form-page">
        
        <!-- CABECERA -->
        <div class="header-institutional">
            <img src="img/Logo_policia.png" style="width: 80px;" onerror="this.style.display='none'">
            <div class="header-text">
                REP√öBLICA DE PANAM√Å<br>
                MINISTERIO DE SEGURIDAD P√öBLICA<br>
                POLIC√çA NACIONAL<br>
                DIRECCI√ìN NACIONAL DE RECURSOS HUMANOS<br>
                DEPARTAMENTO DE RECLUTAMIENTO Y SELECCI√ìN
            </div>
            <div id="foto-container" class="photo-box">FOTO</div>
        </div>

        <!-- FECHA Y CARGO -->
        <div class="row mb-3 align-items-end">
            <div class="col-4">
                <label class="label-sm">FECHA</label>
                <div id="fechaPostulacion" class="form-data"></div>
            </div>
            <div class="col-8">
                <label class="label-sm">POSTULAR√Å PARA EL CARGO DE:</label>
                <div id="postulacionCargo" class="form-data"></div>
            </div>
        </div>

        <!-- SECCI√ìN I: DATOS GENERALES -->
        <div class="box-title">I.- DATOS GENERALES</div>
        <div class="border-section">
            <div class="row mb-3">
                <div class="col-3"><label class="label-sm">1er. Apellido</label><div id="apellido1" class="form-data"></div></div>
                <div class="col-3"><label class="label-sm">2do. Apellido</label><div id="apellido2" class="form-data"></div></div>
                <div class="col-3"><label class="label-sm">1er. Nombre</label><div id="nombre1" class="form-data"></div></div>
                <div class="col-3"><label class="label-sm">2do. Nombre</label><div id="nombre2" class="form-data"></div></div>
            </div>
            <div class="row mb-3">
                <div class="col-4"><label class="label-sm">C√©dula</label><div id="cedula" class="form-data"></div></div>
                <div class="col-4"><label class="label-sm">Apodo</label><div id="apodo" class="form-data"></div></div>
                <div class="col-4"><label class="label-sm">Religi√≥n</label><div id="religion" class="form-data"></div></div>
            </div>
            <div class="row">
                <div class="col-3"><label class="label-sm">Fecha Nac.</label><div id="fechaNac" class="form-data"></div></div>
                <div class="col-2"><label class="label-sm">Edad</label><div id="edad" class="form-data"></div></div>
                <div class="col-2"><label class="label-sm">Tipaje</label><div id="tipaje" class="form-data"></div></div>
                <div class="col-3"><label class="label-sm">Edo. Civil</label><div id="estadoCivil" class="form-data"></div></div>
                <div class="col-2"><label class="label-sm">Idioma</label><div id="idioma" class="form-data"></div></div>
            </div>
        </div>

        <!-- SECCI√ìN II: DIRECCI√ìN -->
        <div class="box-title">II.- DIRECCI√ìN RESIDENCIAL</div>
        <div class="border-section">
            <div class="row mb-3">
                <div class="col-4"><label class="label-sm">Provincia</label><div id="provincia" class="form-data"></div></div>
                <div class="col-4"><label class="label-sm">Distrito</label><div id="distrito" class="form-data"></div></div>
                <div class="col-4"><label class="label-sm">Corregimiento / Sector</label><div id="corregimiento" class="form-data"></div></div>
            </div>
            <div class="row">
                <div class="col-4"><label class="label-sm">N¬∞ Casa y Color</label><div id="casaColor" class="form-data"></div></div>
                <div class="col-4"><label class="label-sm">Tiempo Residencia</label><div id="tiempoResidencia" class="form-data"></div></div>
                <div class="col-4"><label class="label-sm">Tel√©fonos</label><div id="telefonos" class="form-data"></div></div>
            </div>
        </div>

        <!-- SECCI√ìN III: DATOS FAMILIARES -->
        <div class="box-title">III.- DATOS FAMILIARES</div>
        <div class="border-section">
            <div class="row mb-2 border-bottom pb-2">
                <div class="col-7"><label class="label-sm">Nombre del Padre</label><div id="padreNombre" class="form-data"></div></div>
                <div class="col-5"><label class="label-sm">Profesi√≥n / Tel√©fono</label><div id="padreProfesion" class="form-data"></div></div>
            </div>
            <div class="row mb-2">
                <div class="col-7"><label class="label-sm">Nombre de la Madre</label><div id="madreNombre" class="form-data"></div></div>
                <div class="col-5"><label class="label-sm">Profesi√≥n / Tel√©fono</label><div id="madreProfesion" class="form-data"></div></div>
            </div>
            <div class="row mt-3">
                <div class="col-4"><label class="label-sm">¬øVive con ambos padres?</label><div id="viveConPadres" class="form-data"></div></div>
                <div class="col-8"><label class="label-sm">¬øCon qui√©n vive? Indique</label><div id="viveConN" class="form-data"></div></div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const targetCedula = localStorage.getItem('target_cedula');
            const URL_GOOGLE = "https://script.google.com/macros/s/AKfycbzUlNo9ykI2lp6Mk76DXmZFn_tUmfmxeGXN0p76-1hnEmiT88akVJVKNACtMXgtOFJm/exec";

            if (!targetCedula) return;

            fetch(URL_GOOGLE)
                .then(res => res.json())
                .then(data => {
                    const clean = (c) => String(c).replace(/-/g, "").trim();
                    const p = data.find(item => clean(item.cedula) === clean(targetCedula));
                    
                    if (p) {
                        // Funci√≥n que busca el dato con varios nombres posibles (por si cambia el Excel)
                        const setT = (id, keys) => {
                            const el = document.getElementById(id);
                            if (!el) return;
                            // Busca en el objeto 'p' cualquier coincidencia de los nombres enviados
                            let valor = keys.map(k => p[k]).find(v => v !== undefined);
                            el.innerText = valor || '';
                        };

                        // MAPEADO INTELIGENTE (Busca por nombre1, nombre o Nombre1)
                        setT('fechaPostulacion', ['fechaPostulacion', 'fecha']);
                        setT('postulacionCargo', ['postulacionCargo', 'cargo']);
                        
                        setT('apellido1', ['apellido1', 'apellido']);
                        setT('apellido2', ['apellido2']);
                        setT('nombre1', ['nombre1', 'nombre']);
                        setT('nombre2', ['nombre2']);
                        
                        setT('cedula', ['cedula']);
                        setT('apodo', ['apodo']);
                        setT('religion', ['religion']);
                        setT('fechaNac', ['fechaNac', 'fechaNacimiento']);
                        setT('edad', ['edad']);
                        setT('tipaje', ['tipaje']);
                        setT('estadoCivil', ['estadoCivil']);
                        setT('idioma', ['idioma']);

                        // Direcci√≥n
                        setT('provincia', ['provincia']);
                        setT('distrito', ['distrito']);
                        setT('corregimiento', ['corregimiento']);
                        setT('casaColor', ['casaColor']);
                        setT('tiempoResidencia', ['tiempoResidencia']);
                        setT('telefonos', ['telefonos', 'telefono']);

                        // Familia
                        setT('padreNombre', ['padreNombre']);
                        setT('padreProfesion', ['padreProfesion']);
                        setT('madreNombre', ['madreNombre']);
                        setT('madreProfesion', ['madreProfesion']);
                        setT('viveConPadres', ['viveConPadres']);
                        setT('viveConN', ['viveConN', 'conQuienVive']);

                        // Foto
                        if(p.fotoBase64 && p.fotoBase64 !== "Sin foto") {
                            document.getElementById('foto-container').innerHTML = `<img src="${p.fotoBase64}" style="width:100%; height:100%; object-fit:cover;">`;
                        }
                    }
                });
        });
    </script>
</body>
</html>