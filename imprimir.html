<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>FICHA DE INSCRIPCIÓN OFICIAL - PN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f0f0f0; font-family: 'Arial', sans-serif; font-size: 11px; }
        .form-page { width: 215.9mm; min-height: 279.4mm; padding: 12mm; margin: 10px auto; background: white; border: 1px solid #000; }
        .box-title { background-color: #1a2a40; color: white; padding: 4px 15px; font-weight: bold; font-size: 12px; border: 1px solid #000; }
        .border-section { border: 1px solid #000; padding: 10px; margin-bottom: 10px; }
        label { font-weight: bold; font-size: 9px; text-transform: uppercase; display: block; }
        .form-control-print { border: none; border-bottom: 1px solid #000; width: 100%; font-weight: bold; font-size: 11px; background: transparent; }
        @media print { body { background: white; } .form-page { margin: 0; border: 1px solid black; page-break-after: always; } .no-print { display: none !important; } }
    </style>
</head>
<body>

    <div class="no-print text-center py-3">
        <button class="btn btn-primary btn-lg" onclick="window.print()">IMPRIMIR FICHA</button>
    </div>

    <div class="form-page">
        <!-- ENCABEZADO -->
        <div class="row align-items-center mb-3">
            <div class="col-2"><img src="img/Logo_policia.png" style="width: 70px;"></div>
            <div class="col-8 text-center">
                <h6 class="fw-bold m-0">REPÚBLICA DE PANAMÁ<br>POLICÍA NACIONAL<br>FICHA DE RECLUTAMIENTO</h6>
            </div>
            <div id="foto-container" class="col-2 text-end" style="width: 90px; height: 110px; border: 1px solid #000; padding: 0; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                FOTO
            </div>
        </div>

        <div class="box-title">I. DATOS GENERALES</div>
        <div class="border-section">
            <div class="row mb-2">
                <div class="col-6"><label>Nombre Completo</label><input type="text" id="nombre-imprimir" class="form-control-print"></div>
                <div class="col-6"><label>Apellido Completo</label><input type="text" id="apellido-imprimir" class="form-control-print"></div>
            </div>
            <div class="row">
                <div class="col-4"><label>Cédula</label><input type="text" id="cedula-imprimir" class="form-control-print"></div>
                <div class="col-4"><label>Edad</label><input type="text" id="edad-imprimir" class="form-control-print"></div>
                <div class="col-4"><label>Cargo</label><input type="text" id="cargo-imprimir" class="form-control-print"></div>
            </div>
        </div>

        <div class="box-title">II. DATOS RESIDENCIALES</div>
        <div class="border-section">
            <div class="row">
                <div class="col-4"><label>Provincia</label><input type="text" id="prov-imprimir" class="form-control-print"></div>
                <div class="col-8"><label>Dirección Exacta</label><input type="text" id="dir-imprimir" class="form-control-print"></div>
            </div>
        </div>

        <div class="box-title">III. DATOS FAMILIARES</div>
        <div class="border-section">
            <label>Nombre del Padre</label><input type="text" id="padre-imprimir" class="form-control-print" style="margin-bottom: 5px;">
            <label>Nombre de la Madre</label><input type="text" id="madre-imprimir" class="form-control-print">
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const targetCedula = localStorage.getItem('target_cedula');
        const URL_GOOGLE = "https://script.google.com/macros/s/AKfycbyioz415PtfFEFUTHgQeHr7TXPJTiZHsiRWQJdREGdOS6FjeDfCv-3TOB11YIgX0J8g/exec";

            if (!targetCedula) return;

            fetch(URL_GOOGLE)
                .then(res => res.json())
                .then(data => {
                    const p = data.find(item => String(item.cedula).replace(/-/g, "") === String(targetCedula).replace(/-/g, ""));
                    
                    if (p) {
                        // Llenamos los campos usando los nombres que definimos en el doGet
                        document.getElementById('nombre-imprimir').value = p.nombre1 || p.nombre || '';
                        document.getElementById('apellido-imprimir').value = p.apellido1 || p.apellido || '';
                        document.getElementById('cedula-imprimir').value = p.cedula || '';
                        document.getElementById('edad-imprimir').value = p.edad || '';
                        document.getElementById('cargo-imprimir').value = p.postulacionCargo || '';
                        document.getElementById('prov-imprimir').value = p.provincia || '';
                        document.getElementById('dir-imprimir').value = p.resCorregimiento || '';
                        document.getElementById('padre-imprimir').value = p.padreNombre || '';
                        document.getElementById('madre-imprimir').value = p.madreNombre || '';

                        // FOTO
                        if(p.fotoBase64 && p.fotoBase64 !== "Sin foto") {
                            document.getElementById('foto-container').innerHTML = `<img src="${p.fotoBase64}" style="width:100%; height:100%; object-fit:cover;">`;
                        }
                    }
                });
        });
    </script>
</body>
</html>